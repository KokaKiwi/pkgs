# Maintainer: FÃ©lix Saparelli <aur@passcod.name>
# Contributor: Eric Forgeot <http://ifiction.free.fr>
pkgname=glfrontier
pkgver=20060623
pkgrel=2
pkgdesc="A reverse-engineered version of Frontier Elite 2 to allow OpenGL rendering."
arch=('i686' 'x86_64')
url="http://tom.noflag.org.uk/glfrontier.html"
license=('unknown')
depends=('sdl' 'mesa' 'libvorbis')
source=('http://tom.noflag.org.uk/glfrontier/frontvm3-20060623.tar.bz2'
        'http://tom.noflag.org.uk/misc/frontvm-audio-20060222.tar.bz2'
        'glfrontier.desktop'
        'glfrontier')
sha512sums=('45c4b5aaf4f7e2caac632c6af8936992684b048df87c183387283fbb627966e077ac4a50d5e4df0072f025e755a82e43bb9684cb81d1ac4080fc0042d2a36159'
            '50fdd3e7ac5547a0ca2081ab0350a8b7f5ecbeed015d2f3b1947777921fd145cc4475e5fc36910898577d1c9c3fec87d11e0e18240c03490991441c2bd484f6a'
            'f3a703684d06ae1e936c5e86b2105266f0ce26fc605d433e653c6376b1dd24bee6d08489867aec1b3a3e28e7e3c9653299bd42ba724086c89139165550e0806c'
            '1feda011b40248c880d7b8eac9674205f33bbedf8a742b07a09ec9458be9de4db2f26fccc70f1b995997f69740bc789d04430014e8de75c4fe1eada80c2e276f')

build() {
  cd $srcdir/frontvm3-$pkgver
  sed -i -e "s|-lvorbis -logg|-lvorbis -logg -lm|g" Makefile-C
  make -f Makefile-C || return 1
}

package() {
  cd $srcdir
  mkdir -p $pkgdir/usr/share/$pkgname/savs
  chmod 777 $pkgdir/usr/share/$pkgname/savs

  install -Dm644 {frontvm3-$pkgver,$pkgdir/usr/share/$pkgname}/README
  install -Dm644 {frontvm3-$pkgver,$pkgdir/usr/share/$pkgname}/fe2.s.bin
  install -Dm755 {frontvm3-$pkgver,$pkgdir/usr/share/$pkgname}/frontier
  install -Dm644 {,$pkgdir/usr/share/applications/}${pkgname}.desktop
  install -Dm755 {,$pkgdir/usr/bin/}$pkgname

  cp -dr --no-preserve=ownership frontvm3-audio-20060222/{music,sfx} $pkgdir/usr/share/$pkgname/
}
